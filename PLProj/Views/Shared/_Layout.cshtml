@using Microsoft.AspNetCore.Http
@inject UserManager<AppUser> UserManager
@inject IHttpContextAccessor HttpContextAccessor

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - PLProj</title>
	<link rel="stylesheet" href="~/css/style.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
	<link rel="stylesheet" href="~/font-awesome/css/all.min.css" />
	<link rel="stylesheet" href="https://cdn.datatables.net/2.3.0/css/dataTables.dataTables.min.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" />
	<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.4.1/css/responsive.bootstrap5.min.css">
	<link rel="icon" href="imgs/Logo.png" type="image/x-icon">
</head>
<body>
	<header class="site-header">
		<div class="header-container ">

			<div class="left-nav">
				<a asp-action="Index" asp-controller="Home" class="logo"><span>DoorToDoor</span></a>
				<nav class="main-nav">
					<ul>
						@if (User.Identity.IsAuthenticated)
						{
							@if (User.IsInRole(SD.AdminRole))
							{
								<li class="nav-item dropdown">
									<a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"> Admin Menu </a>
									<ul class="dropdown-menu" aria-labelledby="adminDropdown">
										<li> <a class="dropdown-item" asp-controller="Brand" asp-action="Index">Brands</a> </li>
										<li> <a class="dropdown-item" asp-controller="Model" asp-action="Index">Models</a> </li>
										<li> <a class="dropdown-item" asp-controller="Category" asp-action="Index">Categories</a> </li>
										<li> <a class="dropdown-item" asp-controller="User" asp-action="Index">Users</a> </li>
										<li> <a class="dropdown-item" asp-controller="Color" asp-action="Index">Colors</a> </li>
										<li> <a class="dropdown-item" asp-controller="Service" asp-action="Index"> Services </a> </li>
										<li> <a class="dropdown-item" asp-controller="ProductCategory" asp-action="Index"> Product Category</a> </li>
										<li> <a class="dropdown-item" asp-controller="Product" asp-action="Index"> Product </a> </li>
										<li> <a class="dropdown-item" asp-controller="Ticket" asp-action="AllTicket"> Tickets</a> </li>
										<li> <a class="dropdown-item" asp-controller="Order" asp-action="Index"> Orders</a> </li>
									</ul>
								</li>
							}
							else if (User.IsInRole(SD.CustomerRole))
							{
								<li class="nav-item"> <a class="nav-link" asp-controller="Car" asp-action="Index"> Cars </a> </li>
							}
							<li class="nav-item"> <a class="nav-link" asp-controller="Ticket" asp-action="AllTicket"> Tickets </a> </li>
							<li class="nav-item"> <a class="nav-link" asp-controller="Store" asp-action="Index"> Products </a> </li>
							<li class="nav-item"> <a class="nav-link" asp-controller="Order" asp-action="Index">Orders</a> </li>
						}

								
						@if(HttpContextAccessor.HttpContext.Session.GetInt32(SD.SessionCart) != null)
						{
							<li class="nav-item">
								<a class="nav-link"  asp-controller="Cart" asp-action="Index">
									<i class="bi bi-cart"></i> &nbsp;
									(@HttpContextAccessor.HttpContext.Session.GetInt32(SD.SessionCart))
								</a>
							</li>
						}
						else @* Empty or not authorize *@
						{
							<li class="nav-item">
								<a class="nav-link"  asp-controller="Cart" asp-action="Index">
									<i class="bi bi-cart"></i> &nbsp;
									(0)
								</a>
							</li>
						}

					</ul>
				</nav>
			</div>
			<div class="right-nav">
				<ul class="main-nav d-flex align-items-center" style="gap: 10px;">
					@if (User.Identity.IsAuthenticated)
					{
						var currentUser = await UserManager.GetUserAsync(User);
						var fullName = currentUser?.Name ?? "User";
						<li class="nav-item d-flex align-items-center" style="margin-right:30px">
							<a class="nav-link" href="" title="Manage">Hello @fullName !</a>
						</li>
						<li class="nav-item"> <a class="nav-link" asp-controller="Account" asp-action="Logout">Logout</a> </li>
					}
					else
					{
						<li> <a class="nav-link" asp-controller="Account" asp-action="Register">Register</a> </li>
						<li> <a class="nav-link" asp-controller="Account" asp-action="Login">Login</a> </li>
					}
				</ul>
			</div>
		</div>
	</header>

	<main>
		@RenderBody()
	</main>

	<footer class="site-footer">
		<div class="footer-container">
			<div class="footer-info">
				<p> © 2025 CarService. All rights reserved.</p>
				<p> Contact us: <a href="mailto:info@carservice.com"> info@carservice.com</a> | Phone: +123 456 7890</p>
			</div>
			<div class="social-links">
				<a href="#"> FB</a>
				<a href="#"> TW</a>
				<a href="#"> IG</a>
			</div>
		</div>
	</footer>

	<script src="~/lib/jquery/jquery.min.js"> </script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"> </script>
	<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"> </script>
	<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"> </script>
	<script src="//cdn.datatables.net/2.3.0/js/dataTables.min.js"> </script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"> </script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"> </script>
	<script src="https://cdn.datatables.net/responsive/2.4.1/js/dataTables.responsive.min.js"></script>
	<script src="https://cdn.datatables.net/responsive/2.4.1/js/responsive.bootstrap5.min.js"></script>
	@await RenderSectionAsync("Scripts", required: false)

</body>
</html>
